<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Quản lý sinh viên</title>
</head>
<body class="bg-light">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>

    <div class="table-responsive">
        <nav class="navbar navbar-dark bg-dark mb-4" aria-label="First navbar example"> 
            <div class="container-fluid">
                <a class="navbar-brand p-2 fs-4" href="#">Quản lý sinh viên</a> <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample01" aria-controls="navbarsExample01" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <div class="navbar-collapse collapse" id="navbarsExample01" style=""> <ul class="navbar-nav me-auto mb-2"> <li class="nav-item"> <a class="nav-link active" aria-current="page" href="#">Home</a> </li> <li class="nav-item"> <a class="nav-link" href="#">Link</a> </li> <li class="nav-item"> <a class="nav-link disabled" aria-disabled="true">Disabled</a> </li> <li class="nav-item dropdown"> <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" aria-expanded="false">Dropdown</a> <ul class="dropdown-menu"> <li><a class="dropdown-item" href="#">Action</a></li> <li><a class="dropdown-item" href="#">Another action</a></li> <li><a class="dropdown-item" href="#">Something else here</a></li> </ul> </li> </ul> </div>
        </nav>
    <p id="thongBao" class="alert alert-success d-none text-success fw-bold mt-2"></p>
    <div class="container-fluid px-5">
        <div class="row">
            <!-- Form bên trái-->
             <div class="col-md-5">
                <div class="p-2 border rounded bg-white">
                <form class="ps-4 pe-4" id="formSV">
                    <h4 class="mt-3 mb-3 text-danger">Thêm Sinh Viên</h4>
                    <div class="mb-3">
                        <label class="form-label">Mã sinh viên</label>
                        <input type="text" id="maSV" class="form-control border border-secondary-subtle rounded">
                        <span id="loiMasv" class="text-danger small"></span>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Họ và tên</label>
                        <input type="text" id="hoTen" class="form-control border border-secondary-subtle rounded">
                        <span id="loiHoten" class="text-danger small"></span>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="text" id="email" class="form-control border border-secondary-subtle rounded">
                        <span id="loiEmail" class="text-danger small"></span>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ngày sinh</label>
                        <input type="date" id="ngaySinh" class="form-control border border-secondary-subtle rounded">
                        <span id="loiNgaysinh" class="text-danger small"></span>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Giới tính</label><br>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gioitinh" value="Nam" id="nam">
                            <label class="form-check-label" for="nam">Nam</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gioitinh" value="Nữ" id="nu">
                            <label class="form-check-label" for="nu">Nữ</label>
                        </div>
                        <br><span id="loiGioiTinh" class="text-danger small"></span>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ghi chú</label>
                        <textarea class="form-control border border-secondary-subtle rounded" rows="3"></textarea>
                    </div>
                    <div class="text-end">
                        <button type="submit" id="btnThem" class="btn btn-outline-primary ps-4 pe-4 mt-2 mb-3">Thêm</button>
                        <button type="submit" id="btnCapNhat" class="btn btn-outline-success d-none">Cập nhật</button>
                    </div>
                </form>
                </div>
             </div>
            <!-- Bảng bên phải -->
             <div class="col-md-7">
                <div class="p-3 border rounded bg-white">
                <h4 class="text-success">Danh Sách Sinh Viên</h4>
                <table class="table table-hover mt-3" id="bangSinhVien">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Mã SV</th>
                            <th>Họ tên</th>
                            <th>Email</th>
                            <th>Giới tính</th>
                            <th>Ngày sinh</th>
                            <th>Tùy chọn</th>
                        </tr>
                    </thead>
                    <tbody class="table-group-divider">
                        <tr>
                            <th>1</th>
                            <td>2251172271</td>
                            <td>Trần Quốc Huy</td>
                            <td>tranhuy73@gmail.com</td>
                            <td>Nam</td>
                            <td>2004-03-07</td>
                            <td>
                                <a href="#" class="text-warning" onclick="suaDong(this)">Sửa</a>
                                <a href="#" class="text-danger" onclick="xoaDong(this)">Xóa</a>
                            </td>
                        </tr>
                        <tr>
                            <th>2</th>
                            <td>2251172270</td>
                            <td>Phạm Minh Ánh</td>
                            <td>minhanh2901@gmail.com</td>
                            <td>Nữ</td>
                            <td>2006-01-29</td>
                            <td>
                                <a href="#" class="text-warning" onclick="suaDong(this)">Sửa</a>
                                <a href="#" class="text-danger" onclick="xoaDong(this)">Xóa</a>
                            </td>
                        </tr>
                        <tr>
                            <th>3</th>
                            <td>2251172269</td>
                            <td>Nguyễn Tiến Đạt</td>
                            <td>datnguyen1abc@gmail.com</td>
                            <td>Nam</td>
                            <td>2004-04-30</td>
                            <td>
                                <a href="#" class="text-warning" onclick="suaDong(this)">Sửa</a>
                                <a href="#" class="text-danger" onclick="xoaDong(this)">Xóa</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
                </div>
             </div>
            
        </div>
    </div>
    </div>
    <script>
        // Thêm sinh viên
        function themSinhVien(maSV, hoTen, email, gioiTinh, ngaySinh) {
            let table = document.getElementById("bangSinhVien").getElementsByTagName("tbody")[0];
            let newRow = table.insertRow();
            let STT = table.rows.length;

            newRow.innerHTML = `
                <th>${STT}</th>
                <td>${maSV}</td>
                <td>${hoTen}</td>
                <td>${email}</td>
                <td>${gioiTinh}</td>
                <td>${ngaySinh}</td>
                <td>
                    <a href="#" class="text-warning" onclick="suaDong(this)">Sửa</a>
                    <a href="#" class="text-danger" onclick="xoaDong(this)">Xóa</a>
                </td>`;
        }
        //Hiển thị hông báo
        function thongBao(msg) {
            let tb = document.getElementById("thongBao");
            tb.innerText = msg;
            tb.classList.remove("d-none");
            setTimeout(() => {
                tb.innerText = "";
                tb.classList.add("d-none");
            }, 3000);
        }
        // Xóa sinh viên
        function xoaDong(btn) {
            if (confirm("Bạn có chắc chắn muốn xoá?")) {
                let row = btn.closest("tr");
                row.remove();
                thongBao("Xoá sinh viên thành công!");
            }
        }
        // Xác thực đầu vào
        function xacThucDauVao() {
            let maSV = document.getElementById("maSV").value.trim();
            let hoTen = document.getElementById("hoTen").value.trim();
            let email = document.getElementById("email").value.trim();
            let ngaySinh = document.getElementById("ngaySinh").value.trim();
            let gioiTinhChecked = document.querySelector('input[name="gioitinh"]:checked');

            let loiMasv = document.getElementById("loiMasv");
            let loiHoten = document.getElementById("loiHoten");
            let loiEmail = document.getElementById("loiEmail");
            let loiNgaysinh = document.getElementById("loiNgaysinh");
            let loiGioiTinh = document.getElementById("loiGioiTinh");

            loiMasv.innerText = "";
            loiHoten.innerText = "";
            loiEmail.innerText = "";
            loiNgaysinh.innerText = "";
            loiGioiTinh.innerText = "";

            if (maSV === "") {
                loiMasv.innerText = "Mã sinh viên không được để trống";
                return false;
            }
            if (hoTen === "") {
                loiHoten.innerText = "Họ tên không được để trống";
                return false;
            }
            if (email === "") {
                loiEmail.innerText = "Email không được để trống";
                return false;
            }
            const regexEmail = /^\S+@\S+\.\S+$/;
            if (!regexEmail.test(email)) {
                loiEmail.innerText = "Email không hợp lệ";
                return false;
            }
            if (ngaySinh === "") {
                loiNgaysinh.innerText = "Vui lòng chọn ngày sinh";
                return false;
            }
            if (!gioiTinhChecked) {
                loiGioiTinh.innerText = "Vui lòng chọn giới tính";
                return false;
            }

            return {
                maSV,
                hoTen,
                email,
                gioiTinh: gioiTinhChecked.value,
                ngaySinh
            };
        }
        // Sửa thông tin sinh viên
        let selectedRow = null;

        function suaDong(btn) {
            selectedRow = btn.closest("tr");

            document.getElementById("maSV").value = selectedRow.cells[1].innerText;
            document.getElementById("hoTen").value = selectedRow.cells[2].innerText;
            document.getElementById("email").value = selectedRow.cells[3].innerText;
            document.querySelector(`input[name="gioitinh"][value="${selectedRow.cells[4].innerText}"]`).checked = true;
            document.getElementById("ngaySinh").value = selectedRow.cells[5].innerText;

            document.getElementById("btnThem").classList.add("d-none");
            document.getElementById("btnCapNhat").classList.remove("d-none");
        }
        // Cập nhật thông tin sinh viên
        document.getElementById("formSV").addEventListener("submit", function (e) {
            e.preventDefault();
            let data = xacThucDauVao();
            if (!data) return;

            if (selectedRow) {
                selectedRow.cells[1].innerText = data.maSV;
                selectedRow.cells[2].innerText = data.hoTen;
                selectedRow.cells[3].innerText = data.email;
                selectedRow.cells[4].innerText = data.gioiTinh;
                selectedRow.cells[5].innerText = data.ngaySinh;
                thongBao("Cập nhật sinh viên thành công!");
            } else {
                themSinhVien(data.maSV, data.hoTen, data.email, data.gioiTinh, data.ngaySinh);
                thongBao("Thêm sinh viên thành công!");
            }

            this.reset();
            selectedRow = null;
            document.getElementById("btnCapNhat").classList.add("d-none");
            document.getElementById("btnThem").classList.remove("d-none");
        });
    </script>
</body>
</html>